<!-- frontends/templates/components/notification_menu.html -->
{% load i18n %}

<div class="dropdown">
  <button class="btn btn-link text-dark position-relative p-1" 
          type="button" 
          data-bs-toggle="dropdown" 
          aria-expanded="false"
          aria-label="{% trans 'Notifications' %}">
    <i class="bi bi-bell fs-5"></i>
    {% if notification_count %}
      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {{ notification_count }}
        <span class="visually-hidden">{% trans 'unread notifications' %}</span>
      </span>
    {% endif %}
  </button>
  
  <div class="dropdown-menu dropdown-menu-end shadow" style="min-width: 320px;">
    <div class="dropdown-header d-flex justify-content-between align-items-center">
      <span class="fw-semibold">{% trans 'Notifications' %}</span>
      {% if notification_count %}
        <a href="#" class="text-decoration-none small">{% trans 'Mark all as read' %}</a>
      {% endif %}
    </div>
    
    <div class="dropdown-divider"></div>
    
    <div class="notification-list" style="max-height: 300px; overflow-y: auto;">
      {% if notifications %}
        {% for notification in notifications %}
          <a href="{{ notification.url }}" class="dropdown-item py-2 {% if not notification.is_read %}bg-light{% endif %}">
            <div class="d-flex">
              <div class="flex-shrink-0">
                <i class="bi {{ notification.icon|default:'bi-info-circle' }} text-{{ notification.color|default:'primary' }}"></i>
              </div>
              <div class="flex-grow-1 ms-2">
                <p class="mb-0 small">{{ notification.message }}</p>
                <small class="text-muted">{{ notification.created_at|timesince }} {% trans 'ago' %}</small>
              </div>
            </div>
          </a>
        {% endfor %}
      {% else %}
        <div class="dropdown-item-text text-center text-muted py-3">
          <i class="bi bi-bell-slash fs-4 d-block mb-2"></i>
          {% trans 'No notifications' %}
        </div>
      {% endif %}
    </div>
    
    {% if notifications %}
      <div class="dropdown-divider"></div>
      <a href="{% url 'notifications:list' %}" class="dropdown-item text-center small">
        {% trans 'View all notifications' %}
      </a>
    {% endif %}
  </div>
</div>