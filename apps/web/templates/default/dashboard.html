<!-- templates/default/dashboard.html -->
{% load static i18n %}
<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE|default:'vi' }}">
<head>
    <!-- Meta tags for character encoding, compatibility, and responsive viewport -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    
    <!-- Page title with translation support -->
    <title>{% trans "ResSync Dashboard" %}</title>
    
    <!-- Stylesheets: Base, TailwindCSS, and Dashboard-specific -->
    <link rel="stylesheet" href="{% static 'css/default/base.css' %}" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{% static 'css/default/dashboard.css' %}" />
</head>
<body class="bg-gray-100 text-gray-700 h-screen overflow-hidden">
    <!-- Main container for layout -->
    <div class="relative flex h-full">
        <!-- Sidebar: Navigation panel with study logo and dynamic content -->
        <aside id="sidebar" class="bg-blue-950 text-gray-100 flex flex-col"
               role="navigation" aria-label="{% trans 'Primary navigation' %}">
            <div class="flex items-center px-2 py-2 ml-2">
                <div class="flex items-center gap-3">
                    {% if study_folder %}
                        {% static 'images/studies/'|add:study_folder|add:'/logo.webp' as logo_path %}
                        {% if logo_path %}
                            <div class="flex-shrink-0 p-1 bg-white rounded-lg border border-white/10">
                                <img src="{{ logo_path }}"
                                     alt="{% trans 'Study logo' %}"
                                     loading="lazy" class="h-10 w-auto object-contain" decoding="async"
                                     onerror="this.parentElement.style.display='none';">
                            </div>
                        {% endif %}
                    {% endif %}
                    <div class="flex flex-col">
                        <h1 class="text-lg font-bold text-white tracking-wide">{{ request.study.code|upper }}</h1>
                        <p class="text-sm text-slate-300 font-medium">{% trans "Research Study" %}</p>
                    </div>
                </div>
            </div>
            <!-- Include study-specific sidebar content -->
            {% include 'studies/'|add:study_folder|add:'/sidebar.html' with request=request %}
        </aside>

        <!-- Main content area -->
        <div class="flex-1 flex flex-col min-w-0">
            <!-- Header: Top navigation bar -->
            {% include 'includes/header.html' with request=request %}
            <!-- Main content area with study-specific content -->
            <main class="flex-1 overflow-y-auto p-6 md:p-8">
                {% include 'studies/'|add:study_folder|add:'/content.html' with request=request %}
            </main>
        </div>
    </div>

    <!-- JavaScript: Dashboard and study-specific scripts -->
    <script defer src="{% static 'js/default/base.js' %}"></script>
    <script type="module" src="{% static 'js/default/dashboard.js' %}"></script>
    {% with study_js='js/studies/'|add:study_folder|add:'/custom.js' %}
        {% if study_folder %}
            <script type="module" src="{% static study_js %}"></script>
        {% endif %}
    {% endwith %}
</body>
</html>