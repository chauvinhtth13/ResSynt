<!-- templates/default/select_study.html -->
{% load static i18n %}
<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE|default:'vi' }}">
<head>
    <!-- Meta tags for character encoding, compatibility, and responsive viewport -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    
    <!-- Page title with translation support -->
    <title>ResSync — Select Study</title>
    
    <!-- Core stylesheets -->
    <link rel="stylesheet" href="{% static 'css/default/base.css' %}" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Note: Uncomment the following line if output.css is needed -->
    <!-- <link rel="stylesheet" href="{% static 'css/output.css' %}" /> -->
</head>
<body class="min-h-screen text-gray-800 font-sans bg-gray-100">
    <!-- Header with navigation and language/user dropdowns -->
    {% include 'includes/header.html' %}
    
    <!-- Main content wrapper -->
    <main class="mx-auto max-w-max p-4 sm:p-6 lg:p-8 space-y-6">
        
        <!-- Study search section -->
        <section role="search" aria-labelledby="study-search-title">
            <div class="mx-auto w-full">
                <div class="relative">
                    <div class="flex items-center rounded-full border border-slate-300 bg-white transition focus-within:border-blue-400 focus-within:ring-0 focus-within:ring-blue-500">
                        <span class="pl-4 text-gray-400" aria-hidden="true">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </span>
                        <input id="study-id-search" type="search" autocomplete="off" enterkeyhint="search" placeholder="{% trans 'Tìm theo Mã hoặc Tên Nghiên Cứu…' %}" class="w-full bg-white px-3 py-3 text-sm text-gray-700 placeholder:text-gray-400 focus:outline-none rounded-full">
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Study table section -->
        <section class="overflow-hidden rounded-3xl bg-white border border-slate-200">
            <!-- Table header -->
            <div class="flex items-center justify-between border-b border-slate-200 px-4 sm:px-6 lg:px-8 py-4">
                <h2 class="text-lg sm:text-xl font-bold">{% trans 'Danh Sách Các Nghiên Cứu' %}</h2>
            </div>
            
            <!-- Table with responsive overflow -->
            <div class="flex flex-col overflow-x-auto">
                <table class="w-full text-sm table-fixed overflow-hidden">
                    <thead class="bg-slate-200 text-slate-700">
                        <tr>
                        <!-- Column widths are fixed using w-[%] classes -->
                            <th scope="col" class="w-[15%] px-4 sm:px-6 lg:px-8 py-4 text-left uppercase tracking-wider font-bold whitespace-nowrap">{% trans 'Mã nghiên cứu' %}</th>
                            <th scope="col" class="w-[45%] px-4 sm:px-6 lg:px-8 py-4 text-left uppercase tracking-wider font-bold whitespace-nowrap">{% trans 'Tên nghiên cứu' %}</th>
                            <th scope="col" class="w-[20%] px-4 sm:px-6 lg:px-8 py-4 text-left uppercase tracking-wider font-bold whitespace-nowrap">{% trans 'Lần cập nhật cuối' %}</th>
                            <th scope="col" class="w-[20%] px-4 sm:px-6 lg:px-8 py-4 text-left uppercase tracking-wider font-bold whitespace-nowrap">{% trans 'Hành động' %}</th>
                        </tr>
                    </thead>
                    <tbody id="studies-body">
                        {% for study in studies %}
                        <tr class="border-b border-slate-200 last:border-0" data-row>
                            <td class="h-12 px-4 sm:px-6 lg:px-8 py-4font-semibold overflow-hidden whitespace-nowrap text-ellipsis" data-col="code">{{ study.code }}</td>
                            <td class="h-12 px-4 sm:px-6 lg:px-8 py-4 overflow-hidden text-ellipsis" data-col="name">{{ study.name|default_if_none:_('(No name)') }}</td>
                            <td class="h-12 px-4 sm:px-6 lg:px-8 py-4 overflow-hidden text-ellipsis" data-col="updated">{{ study.updated_at|date:"d-m-Y H:i:s" }}</td>
                            <td class="h-12 px-4 sm:px-6 lg:px-8 py-4">
                                <form method="post" action="{% url 'select_study' %}">
                                    {% csrf_token %}
                                    <input type="hidden" name="study_id" value="{{ study.id }}">
                                    <button type="submit" class="w-full inline-flex items-center gap-2 rounded-lg bg-blue-500 px-2 py-3 font-semibold text-white shadow-sm transition hover:bg-blue-700 hover:shadow-md active:scale-95 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 whitespace-nowrap">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor" aria-hidden="true" class="inline-block h-5 w-5">
                                            <path d="M507-480 384-357l56 57 180-180-180-180-56 57 123 123ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/>
                                        </svg>
                                        <span class="inline-block">{% trans 'Vào nghiên cứu' %}</span>
                                    </button>
                                </form>
                            </td>
                        </tr>
                        {% empty %}
                        <tr id="no-results-row" data-empty-row>
                            <td colspan="4" class="px-4 sm:px-6 lg:px-8 py-6 text-center text-gray-500">{% trans 'No studies found.' %}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </section>
    </main>
    
    <!-- JavaScript for study selection and search functionality -->
    <script defer src="{% static 'js/default/base.js' %}"></script>
    <script defer src="{% static 'js/default/select_study.js' %}"></script>
</body>
</html>